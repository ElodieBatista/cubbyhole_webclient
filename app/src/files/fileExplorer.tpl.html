<div class="primary" id="file-explorer-container">

  <div class="panel-left-content col-md-3" id="tree-view"></div>

  <div id="file-explorer-progress-bar"></div>

  <div class="col-md-9" id="grid-view" ng-file-drop="onFileSelect(null, $files)" ng-file-drag-over-class="upload-container-hover" ng-file-drag-over-class-cond="!.dnd-drag">

    <ul class="row action-bar">
      <li class="action-bar-item action-bar-item-special" ng-show="selectedNode.parent.parent !== null" ng-click="feSelectNode(selectedNode.parent)">
        <svg class="action-bar-icon action-bar-icon-small" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <g>
            <polygon fill="#000000" points="100,48 7.656,48 52.326,3.331 49.497,0.503 2.828,47.172
            0,50 2.828,52.828 49.497,99.497 52.325,96.669 7.656,52    100,52  "/>
          </g>
        </svg>
      </li>

      <li class="action-bar-item" data-toggle="modal" ng-click="feOpenModalNewFolder()">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <path fill="#000000" d="M92.092,58.906C89.264,56.078,85.688,54.465,82,54.04V26.806C82,25.149,80.657,24,79,24H36.502l-8.203-7.364
          C27.746,16.128,27.023,16,26.272,16H6.5C4.843,16,3,16.843,3,18.5V70c0,1.657,1.843,3,3.5,3h56.637
          c0.439,3.657,2.047,7.201,4.854,10.009c6.656,6.655,17.447,6.655,24.104,0S98.748,65.563,92.092,58.906z M6,70V19h20h0.272l9.063,8
          H79v26.965c-4.008,0.244-7.946,1.88-11.009,4.941c-3.084,3.084-4.72,7.057-4.946,11.094H6z M91.881,73H82v10.047
          c0,0.828-0.672,1.5-1.5,1.5c-0.829,0-1.5-0.672-1.5-1.5V73H68.611c-0.828,0-1.5-0.672-1.5-1.5s0.671-1.5,1.5-1.5H79V59.779
          c0-0.828,0.672-1.5,1.5-1.5s1.5,0.672,1.5,1.5V70h9.881c0.828,0,1.5,0.672,1.5,1.5S92.709,73,91.881,73z"/>
        </svg>
        <span>Create Folder</span>
      </li>
      <li class="action-bar-item" ng-click="feOpenModalNewFiles()">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <g>
            <path fill="#000000" d="M29,23h36c0.553,0,1-0.448,1-1s-0.447-1-1-1H29c-0.552,0-1,0.448-1,1S28.448,23,29,23z"/>
            <path fill="#000000" d="M29,37h36c0.553,0,1-0.448,1-1s-0.447-1-1-1H29c-0.552,0-1,0.448-1,1S28.448,37,29,37z"/>
            <path fill="#000000" d="M29,49h36c0.553,0,1-0.448,1-1s-0.447-1-1-1H29c-0.552,0-1,0.448-1,1S28.448,49,29,49z"/>
            <path fill="#000000" d="M65,62c0.553,0,1-0.447,1-1s-0.447-1-1-1H29c-0.552,0-1,0.447-1,1s0.448,1,1,1H65z"/>
            <path fill="#000000" d="M87.134,68.989C84.295,66.15,80.702,64.534,77,64.117V13c0-0.542-0.291-1.013-0.722-1.277
            c-0.104-0.171-0.236-0.325-0.398-0.441l-9.348-8.87c-0.344-0.326-0.813-0.457-1.266-0.385C65.18,2.011,65.092,2,65,2H18.5
            C17.671,2,17,2.671,17,3.5V9h-5.5C10.671,9,10,9.671,10,10.5v78c0,0.828,0.671,1.5,1.5,1.5h49.102
            c0.68,1.097,1.479,2.14,2.431,3.092c6.656,6.655,17.447,6.655,24.104,0S93.79,75.646,87.134,68.989z M20,5h44v7.5
            c0,0.829,0.672,1.5,1.5,1.5H74v50.051c-3.993,0.253-7.915,1.888-10.967,4.938c-3.063,3.063-4.698,7.002-4.941,11.011H20V5z M13,87
            V12h4v69.5c0,0.828,0.671,1.5,1.5,1.5h39.667c0.156,1.36,0.479,2.702,0.964,4H13z M86.923,83H77v10.13c0,0.828-0.672,1.5-1.5,1.5
            c-0.829,0-1.5-0.672-1.5-1.5V83H63.653c-0.828,0-1.5-0.672-1.5-1.5s0.671-1.5,1.5-1.5H74V69.862c0-0.828,0.672-1.5,1.5-1.5
            s1.5,0.672,1.5,1.5V80h9.923c0.828,0,1.5,0.672,1.5,1.5S87.751,83,86.923,83z"/>
          </g>
        </svg>
        <span>Add Files</span>
      </li>

      <li class="action-bar-separator" ng-show="itemActive"></li>

      <li class="action-bar-item" ng-show="itemActive" ng-click="feOpenModalDeleteItem(itemActive)">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <g transform="translate(0.000000,2000.000000) scale(0.100000,-0.100000)">
            <path fill="#000000" d="M356.924,19999.627c-26.738-3.477-49.59-23.662-56.396-49.893c-1.748-6.709-2.305-12.598-2.305-23.408
            v-9.629H171.787c-141.943,0-128.984,0.361-133.799-3.945c-3.633-3.281-4.717-5.635-5.02-10.703
            c-0.205-3.691-0.049-4.561,1.025-6.973c1.738-3.838,4.043-6.25,7.48-7.939l2.92-1.436l30.322-0.156l30.322-0.146l0.264-1.641
            c0.146-0.928,0.869-12.812,1.582-26.484c0.723-13.682,2.363-43.027,3.643-65.312c3.125-56.348,6.045-108.086,8.145-145.742
            c0.967-17.617,2.256-40.059,2.812-49.941c0.566-9.834,2.051-36.377,3.33-58.916c3.281-59.062,6.611-118.027,8.965-160.078
            c1.133-20.137,3.232-57.119,4.609-82.217c1.436-25.049,3.027-53.633,3.594-63.525c0.557-9.834,2.607-46.875,4.609-82.217
            c4.707-84.16,4.961-88.057,6.094-93.232c3.379-15.107,11.426-28.682,22.842-38.574c9.893-8.555,20.391-13.73,33.604-16.592
            c4.102-0.879,16.445-0.928,288.867-0.928h284.57l5.322,1.182c31.348,7.012,54.092,32.783,56.66,64.131
            c0.146,2.1,1.787,30.586,3.584,63.271c1.797,32.676,3.535,63.467,3.838,68.379c0.312,4.922,1.689,29.609,3.076,54.814
            c2.871,51.689,4.922,88.115,7.168,127.812c1.494,26.23,4.15,74.023,14.6,259.717c2.666,47.9,5.586,99.326,6.406,114.238
            c4.922,87.031,7.178,127.803,7.178,129.697v2.158l33.955,0.146c33.506,0.156,33.965,0.156,36.318,1.289
            c5.996,2.764,9.326,7.939,9.326,14.492c0,6.201-2.969,11.064-8.301,13.682l-2.92,1.436l-127.041,0.254l-127.041,0.254
            l-0.303,12.549c-0.205,9.072-0.518,13.682-1.182,16.543c-2.969,13.584-8.965,24.443-18.691,34.229
            c-7.891,7.881-16.035,12.959-26.279,16.387c-10.459,3.535,3.115,3.232-154.863,3.33
            C422.344,20000.037,358.926,19999.891,356.924,19999.627z M643.896,19968.123c7.627-1.582,13.672-4.863,19.053-10.449
            c4.053-4.15,6.768-8.604,8.555-14.082c1.279-3.848,1.387-4.873,1.592-15.469l0.205-11.426H501.328H329.365l0.205,11.162
            c0.303,12.354,0.82,14.961,4.307,21.67c5.117,9.736,15.205,17.061,26.221,18.906c1.338,0.205,64.854,0.41,141.133,0.459
            C626.221,19968.943,640.312,19968.846,643.896,19968.123z M859.15,19883.963c0-0.771-1.025-19.727-2.305-42.109
            c-2.256-40.723-5.127-91.748-8.965-160.029c-2.773-49.482-5.381-95.898-6.914-122.949c-0.723-12.393-2.207-39.131-3.33-59.414
            c-1.133-20.293-2.871-51.074-3.848-68.389s-3.076-54.199-4.609-81.963s-3.281-58.506-3.838-68.389
            c-1.182-20.957-4.463-79.609-8.457-150.859c-3.486-62.246-3.633-64.961-4.658-68.799c-3.896-15.059-17.373-27.207-32.734-29.561
            c-2.51-0.361-87.344-0.508-283.799-0.41c-264.941,0.156-280.361,0.205-283.281,1.025c-1.689,0.518-5.273,2.002-7.939,3.33
            c-4.15,2.051-5.635,3.174-10.039,7.578c-4.658,4.619-5.43,5.693-7.783,10.508c-3.232,6.66-3.994,10.342-4.717,23.564
            c-0.869,16.65-3.945,71.562-6.406,115c-1.279,22.539-4.863,86.162-7.939,141.387c-3.066,55.225-6.66,118.945-7.939,141.641
            s-3.018,53.477-3.838,68.389c-0.869,14.951-2.1,37.549-2.822,50.195c-0.713,12.705-1.738,30.996-2.305,40.732
            c-0.557,9.727-3.535,63.105-6.66,118.584c-3.125,55.527-5.986,106.758-6.396,113.926c-0.41,7.119-0.771,14.248-0.771,15.732v2.764
            h361.143H859.15V19883.963z"/>
            <path fill="#000000" d="M341.348,19775.613c-5.117-1.279-9.629-5.635-11.113-10.703c-0.664-2.402-0.771-36.211-0.664-302.598
            l0.156-299.922l1.221-2.51c3.594-7.334,12.197-10.811,19.678-7.998c3.994,1.484,7.529,5.02,8.965,8.867l1.123,2.969v299.57
            c0,266.689-0.098,299.834-0.762,302.188c-1.025,3.379-4.971,7.783-8.301,9.219
            C348.32,19776.082,344.629,19776.434,341.348,19775.613z"/>
            <path fill="#000000" d="M498.516,19775.877c-4.922-0.977-9.277-4.512-11.475-9.229l-1.074-2.354v-300.693v-300.703l1.328-2.871
            c1.592-3.379,4.307-6.143,7.578-7.734c3.594-1.787,9.531-1.689,13.477,0.254c3.125,1.543,5.381,3.799,7.168,7.178l1.182,2.148
            l0.156,300.439c0.098,266.689,0,300.703-0.664,303.115c-1.025,3.428-4.922,7.832-8.301,9.268
            C505.019,19775.877,501.074,19776.385,498.516,19775.877z"/>
            <path fill="#000000" d="M644.15,19775.818c-5.127-1.074-10.244-5.576-11.68-10.391c-0.664-2.305-0.771-36.475-0.771-302.139
            v-299.57l1.074-2.92c1.338-3.486,4.619-6.963,8.047-8.555c3.486-1.592,9.678-1.592,13.008,0.049
            c3.125,1.543,5.996,4.404,7.588,7.529l1.279,2.568v300.947v300.957l-1.074,2.354
            C658.496,19773.416,651.172,19777.254,644.15,19775.818z"/>
          </g>
        </svg>
        <span>Delete</span>
      </li>
      <li class="action-bar-item" ng-show="itemActive && selectedNode.parent.parent !== null" ng-click="moveItem(itemActive, selectedNode.parent)">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <path fill="#000000" d="M15.353,66.282L5.836,90.725c-0.225,0.579-0.083,1.229,0.357,1.663c0.002,0.003,0.005,0.006,0.011,0.011
          c0.438,0.421,1.085,0.547,1.655,0.312l24.315-9.931c0.275-0.069,0.529-0.217,0.728-0.424l58.195-60.49
          c0.354-0.371,0.506-0.895,0.396-1.395l-1.731-8.015c-0.063-0.299-0.226-0.575-0.445-0.785l-5.172-4.983
          c-0.225-0.213-0.506-0.357-0.806-0.409l-8.085-1.432C74.751,4.76,74.23,4.931,73.868,5.3L15.945,65.552
          C15.685,65.721,15.473,65.962,15.353,66.282z M86.194,13.17L30.236,71.331l-3.438-3.308L82.865,9.746l3.458,3.32
          C86.278,13.096,86.236,13.13,86.194,13.17z M24.128,69.742l4.499,4.323l1.375,6.264l-12.488,5.099
          c-0.475-0.909-1.24-1.83-1.975-2.538l0,0c-0.733-0.702-1.686-1.435-2.615-1.876l4.834-12.401L24.128,69.742z M32.681,78.133
          l-1.049-4.786L87.267,15.52l1.038,4.796L32.681,78.133z M80.355,8.885L24.726,66.712l-4.796-0.854L75.528,8.031L80.355,8.885z"/>
        </svg>
        <span>Move Up</span>
      </li>
      <li class="action-bar-item" ng-show="itemActive" ng-click="feOpenModalRenameItem(itemActive)">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <path fill="#000000" d="M15.353,66.282L5.836,90.725c-0.225,0.579-0.083,1.229,0.357,1.663c0.002,0.003,0.005,0.006,0.011,0.011
          c0.438,0.421,1.085,0.547,1.655,0.312l24.315-9.931c0.275-0.069,0.529-0.217,0.728-0.424l58.195-60.49
          c0.354-0.371,0.506-0.895,0.396-1.395l-1.731-8.015c-0.063-0.299-0.226-0.575-0.445-0.785l-5.172-4.983
          c-0.225-0.213-0.506-0.357-0.806-0.409l-8.085-1.432C74.751,4.76,74.23,4.931,73.868,5.3L15.945,65.552
          C15.685,65.721,15.473,65.962,15.353,66.282z M86.194,13.17L30.236,71.331l-3.438-3.308L82.865,9.746l3.458,3.32
          C86.278,13.096,86.236,13.13,86.194,13.17z M24.128,69.742l4.499,4.323l1.375,6.264l-12.488,5.099
          c-0.475-0.909-1.24-1.83-1.975-2.538l0,0c-0.733-0.702-1.686-1.435-2.615-1.876l4.834-12.401L24.128,69.742z M32.681,78.133
          l-1.049-4.786L87.267,15.52l1.038,4.796L32.681,78.133z M80.355,8.885L24.726,66.712l-4.796-0.854L75.528,8.031L80.355,8.885z"/>
        </svg>
        <span>Rename</span>
      </li>
      <li class="action-bar-item" ng-show="itemActive && itemActive.type === 'folder'" ng-click="feSelectNode(itemActive)">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <path fill="#000000" d="M100,31.806c0-2.07-1.678-3.75-3.75-3.75h-0.323c-0.348-1.711-1.859-3-3.675-3H41.181l-9.803-11.374l-0.019,0.005
          c-0.681-0.696-1.628-1.13-2.679-1.13H3.75c-2.071,0-3.749,1.679-3.749,3.75v67.38L0,83.693c0,2.071,1.678,3.75,3.748,3.75H3.75
          h16.873h0.002H37.5h0.001H92.25h0.002c2.072,0,3.75-1.679,3.75-3.75v-0.025L100,31.806z M37.5,84.443H20.623H3.748
          c-0.389,0-0.709-0.298-0.745-0.679L6.991,31.96C6.997,31.883,7,31.806,7,31.729c0-0.414,0.335-0.75,0.747-0.75h0.721l87.534,0.076
          l0,0h0.248c0.39,0,0.711,0.299,0.747,0.679l-0.995,12.907l0,0l-2.993,38.821C93.003,83.539,93,83.616,93,83.693
          c0,0.413-0.337,0.75-0.75,0.75H37.5z"/>
        </svg>
        <span>Open</span>
      </li>
      <li class="action-bar-item" ng-show="itemActive && itemActive.type === 'file' || itemActive.children.length > 0" ng-click="feDownloadItem()">
        <svg class="action-bar-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="100px" height="100px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <path fill="#000000" d="M41.492,20.287c7.653,0,14.313,4.217,17.811,10.448c1.229-0.389,2.535-0.601,3.893-0.601c5.82,0,10.735,3.858,12.34,9.155
          c10.384,0.961,18.517,9.689,18.517,20.323c0,11.278-9.143,20.42-20.42,20.42H26.368c-11.277,0-20.42-9.142-20.42-20.42
          c0-9.457,6.438-17.39,15.165-19.712C21.54,28.999,30.487,20.287,41.492,20.287 M41.492,17.287c-11.893,0-21.701,8.784-23.197,20.36
          C9.16,40.997,2.948,49.744,2.948,59.611c0,12.914,10.506,23.42,23.42,23.42h47.264c12.914,0,23.42-10.506,23.42-23.42
          c0-11.522-8.187-21.12-19.337-23.058c-2.525-5.707-8.137-9.42-14.52-9.42c-0.837,0-1.669,0.065-2.491,0.196
          C56.35,21.083,49.18,17.287,41.492,17.287L41.492,17.287z"/>
          <path fill="#000000" d="M40.819,62.283l7.19,7.191c0.543,0.545,1.294,0.883,2.124,0.883c0.827,0,1.576-0.336,2.118-0.877
          c0.001,0,0.002-0.002,0.003-0.002l7.193-7.195c1.172-1.171,1.172-3.07,0-4.241c-1.172-1.173-3.133-1.173-4.305,0l-2.135,2.072V42.3
          c0-1.656-1.343-3-3-3s-3,1.344-3,3v17.814l-2.012-2.072c-0.584-0.587-1.321-0.88-2.09-0.88c-0.768,0-1.52,0.293-2.104,0.88
          C39.631,59.213,39.647,61.112,40.819,62.283z"/>
        </svg>
        <span>Download</span>
      </li>
    </ul>

    <div class="row grid-view-table-container">
      <table class="col-md-12 grid-view-table">
        <thead>
          <tr class="grid-view-table-header">
            <th>Name</th>
            <th>Type</th>
            <th>Size</th>
            <th>Modified</th>
          </tr>
        </thead>
        <tbody>
          <tr class="grid-view-table-tr" ng-class="{true:'itemActive',false:''}[itemActive.name == file.name]" ng-repeat="file in files track by $index" ng-click="toggleItem(file)"
              droppable item="file" doDrop="moveItem" candrop="file.type === 'folder'">
            <td class="grid-view-table-td-first" draggable item="file">
              <img class="grid-view-table-icon" ng-src="/styles/icons/icon_{{file.type}}.svg" />

              <span class="grid-view-table-filename" ng-if="file.type === 'folder'" ng-click="feSelectNode(file)">{{file.name}}</span>
              <span class="grid-view-table-filename" ng-if="file.type === 'file'" ng-click="feAskDownloadConfirm(file); $event.stopPropagation();">{{file.name}}</span>
            </td>
            <td>
              <span ng-if="file.type === 'folder'" ng-bind="file.type"></span>
              <span ng-if="file.type === 'file'" ng-bind="file.meta.type"></span>
            </td>
            <td>
              <span ng-if="file.type === 'folder'">-</span>
              <span ng-if="file.type === 'file'" ng-bind="file.meta.size | size"></span>
            </td>
            <td>{{file.lastModified | date}}</td>
          </tr>
        </tbody>
      </table>

      <p class="col-md-12" id="grid-view-msg" ng-show="files.length === 0">
        This folder is empty. <span class="grid-view-highlight">Drag and drop</span> some folders and files here!
      </p>

    </div>

    <div class="upload-progress-container" ng-show="uploading">
      <button class="upload-btn" ng-click="upload.abort()">Cancel Upload</button>
    </div>

  </div>

  <form id="file-explorer-form-download" method="GET" action="http://localhost:3000/item/{{itemActiveId}}/download/{{token}}">
  </form>
</div>

<modal class="primary" modal-opts="modalOpts" modalform="modalform"></modal>